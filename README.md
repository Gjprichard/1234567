# 期权市场监控系统

## 项目概述
本项目是一个期权市场监控系统，用于实时监控和分析加密货币期权市场数据，提供市场异常检测、风险评估和可视化分析功能。

## 主要功能
- 实时获取期权合约数据和市场行情
- 期权定价和希腊字母计算
- 市场异常检测和风险评估
- 数据可视化和分析报告
- API服务和Web界面展示

## 技术栈
- 后端：Python, Flask, SQLite
- 前端：Streamlit, Vue.js
- 数据分析：Pandas, NumPy
- 可视化：Plotly, Matplotlib

## 最新优化内容 (2025-02-28)
1. 修复数据库结构问题
   - 重构了数据库表结构
   - 增加了option_tickers表与option_contracts表的外键关联
   - 优化了数据存储和查询效率

2. 增加指数回退算法处理429错误
   - 实现了请求限流处理机制
   - 优化了API请求重试逻辑
   - 减少了因请求过频导致的服务中断

3. 优化数据过滤逻辑
   - 改进了无效数据的过滤算法
   - 增强了数据一致性检查
   - 提高了数据质量和可靠性

4. 增加批量获取市场数据功能
   - 实现了批量数据请求和处理
   - 提高了数据获取效率
   - 减少了API请求次数

## 使用说明
1. 安装依赖：`pip install -r requirements.txt`
2. 配置环境变量：编辑`.env`文件
3. 启动API服务：`python api.py`
4. 启动Web界面：`streamlit run streamlit_app.py --server.port 8510`

## 注意事项
- API服务默认运行在端口5002
- Streamlit应用默认运行在端口8510
- 确保数据库文件`option_data.db`存在并正确配置

## 问题排查
如遇到端口冲突，可修改端口号：
- API服务：修改`api.py`中的端口配置
- Streamlit应用：使用`--server.port`参数指定不同端口